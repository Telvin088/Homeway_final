{% extends "shop/base.html" %}
{% block title %}Home{% endblock %}
{% block content %}
<!-- <div class="bg-white rounded shadow p-8 mt-8 text-center">
    <h2 class="text-3xl font-extrabold mb-4 text-gray-800">Welcome, {{ username }}!</h2>
    <p class="text-lg text-gray-600 mb-2">Your user ID is: <span class="font-mono">{{ user_id }}</span></p>
    <p class="text-gray-500">Enjoy shopping with us!</p>
</div> -->

<!-- Main Content -->
<div class="flex border" style="width: 1300px; margin-left: -22px;">
    <!-- Sidebar Categories -->
    <div class="border-r relative" style="width: 180px;">

        {% if categories %}
        {% for category in categories %}
        <div class="py-3 border-b flex items-center justify-between hover:bg-gray-50 cursor-pointer category-item relative" data-category-id="{{ category.id }}">
            <!-- <span style="font-size: 17px; font-variation-settings: 'wght' 400;" class="material-symbols-outlined">
                nutrition
            </span> -->
            <span style="font-size: 10px; color: #030712;" class="font-normal">
                {{ category.name }}
            </span>
            {% if category.subcategories.all %}
            <span class="material-symbols-outlined mr-2" style="font-size: 15px; font-variation-settings: 'wght' 400;">
                chevron_right
            </span>
            {% endif %}
            
            <!-- Subcategories Popup -->
            {% if category.subcategories.all %}
            <div class="subcategories-popup absolute left-full top-0 bg-white border border-gray-200 rounded-lg shadow-lg z-10 min-w-48 opacity-0 invisible transition-all duration-200 ease-in-out transform translate-x-2">
                <div class="p-3">
                    <h4 class="font-semibold text-sm text-gray-800 mb-2 border-b pb-1">{{ category.name }}</h4>
                    {% for subcategory in category.subcategories.all %}
                    <div class="py-1 px-2 hover:bg-gray-50 rounded cursor-pointer text-xs text-gray-700 hover:text-grogin-purple transition-colors">
                        {{ subcategory.name }}
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>

        {% endfor %}
        {% else %}
        <p class="text-sm text-gray-500">No categories available.</p>
        {% endif %}

    </div>

    <!-- Main Banner -->
    <div class="flex-1 p-4">
        <div class="starter-template bg-gray-100 rounded-lg overflow-hidden relative p-5" style="height: 363px;">
            <div class="absolute top-4 left-4 px-8 py-2">
                <span class="bg-green-500 text-white text-xs px-2 py-2 rounded font-bold" style="font-size: 9px; color: #166534;">Weekend Discount</span>
            </div>
            <div class="flex">
                <div class="p-8 w-1/2">
                    <h2 class="text-3xl font-bold text-purple-900 mb-2 mt-4" style="font-size: 31px; color: #39245f; line-height: 1.2;">Get the best quality products<br>at the lowest
                        prices</h2>
                    <p class="text-gray-700 mb-6 mt-2" style="color: #030712; font-size: 12px; line-height: -0.3;">We have prepared special discounts for you on grocery products.
                        Don't miss these opportunities...</p>
                    <div class="flex items-center gap-4">
                        <button
                            class="hover:bg-grogin-dark-purple font-bold text-white px-4 py-2 rounded flex items-center" style="background-color: #634c9f; font-size: 14px;">
                            Shop Now
                            <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                        <!-- <div>
                            <span class="text-red-500 text-2xl font-bold">$27.89</span>
                            <span class="text-gray-500 line-through ml-2">$56.87</span>
                            <div class="text-xs text-gray-500">Don't miss the special deal offer</div>
                        </div> -->
                    </div>
                </div>
                <div class="w-1/2">
                    <img src="https://www.saffronroad.com/cdn/shop/files/Category-SimmerSauce_900x_0ab540c7-dabc-4748-b1e2-a8dcccd56eaa_3024x.png?v=1626078573?height=300&width=500" alt="Grocery Products"
                        class="h-full w-full object-cover" style="">
                </div>
            </div>
            <!-- Pagination Dots -->
            <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-1">
                <span class="w-2 h-2 bg-grogin-purple rounded-full"></span>
                <span class="w-2 h-2 bg-gray-300 rounded-full"></span>
                <span class="w-2 h-2 bg-gray-300 rounded-full"></span>
                <span class="w-2 h-2 bg-gray-300 rounded-full"></span>
            </div>
        </div>
    </div>
</div>

<style>
    .category-item:hover .subcategories-popup {
        opacity: 1;
        visibility: visible;
        transform: translateX(0);
    }
    
    .subcategories-popup {
        max-height: 300px;
        overflow-y: auto;
    }
    
    .subcategories-popup::-webkit-scrollbar {
        width: 4px;
    }
    
    .subcategories-popup::-webkit-scrollbar-thumb {
        background-color: #d1d5db;
        border-radius: 2px;
    }
</style>

<script>
    // Countdown Timer
    function updateCountdown() {
        const hours = document.getElementById('hours');
        const days = document.getElementById('days');
        const minutes = document.getElementById('minutes');
        const seconds = document.getElementById('seconds');

        let secondsValue = parseInt(seconds.textContent);
        let minutesValue = parseInt(minutes.textContent);
        let hoursValue = parseInt(hours.textContent);
        let daysValue = parseInt(days.textContent);

        secondsValue--;

        if (secondsValue < 0) {
            secondsValue = 59;
            minutesValue--;

            if (minutesValue < 0) {
                minutesValue = 59;
                hoursValue--;

                if (hoursValue < 0) {
                    hoursValue = 23;
                    daysValue--;

                    if (daysValue < 0) {
                        // Sale ended
                        daysValue = 0;
                        hoursValue = 0;
                        minutesValue = 0;
                        secondsValue = 0;
                    }
                }
            }
        }

        seconds.textContent = secondsValue < 10 ? '0' + secondsValue : secondsValue;
        minutes.textContent = minutesValue < 10 ? '0' + minutesValue : minutesValue;
        hours.textContent = hoursValue < 10 ? '0' + hoursValue : hoursValue;
        days.textContent = daysValue;
    }

    // Update countdown every second
    setInterval(updateCountdown, 1000);

    // Category hover effect
    document.addEventListener('DOMContentLoaded', function() {
        const categoryItems = document.querySelectorAll('.category-item');
        
        categoryItems.forEach(item => {
            const popup = item.querySelector('.subcategories-popup');
            
            if (popup) {
                item.addEventListener('mouseenter', function() {
                    // Hide all other popups first
                    document.querySelectorAll('.subcategories-popup').forEach(p => {
                        if (p !== popup) {
                            p.style.opacity = '0';
                            p.style.visibility = 'hidden';
                            p.style.transform = 'translateX(8px)';
                        }
                    });
                    
                    // Show current popup
                    popup.style.opacity = '1';
                    popup.style.visibility = 'visible';
                    popup.style.transform = 'translateX(0)';
                });
                
                item.addEventListener('mouseleave', function() {
                    setTimeout(() => {
                        if (!popup.matches(':hover') && !item.matches(':hover')) {
                            popup.style.opacity = '0';
                            popup.style.visibility = 'hidden';
                            popup.style.transform = 'translateX(8px)';
                        }
                    }, 100);
                });
                
                // Keep popup visible when hovering over it
                popup.addEventListener('mouseenter', function() {
                    popup.style.opacity = '1';
                    popup.style.visibility = 'visible';
                    popup.style.transform = 'translateX(0)';
                });
                
                popup.addEventListener('mouseleave', function() {
                    popup.style.opacity = '0';
                    popup.style.visibility = 'hidden';
                    popup.style.transform = 'translateX(8px)';
                });
            }
        });
    });
</script>


{% endblock %}